(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     35813,        779]
NotebookOptionsPosition[     35137,        760]
NotebookOutlinePosition[     35666,        779]
CellTagsIndexPosition[     35623,        776]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"codes", " ", "for", " ", "Table", " ", "10"}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.8589098113411016`*^9, 
  3.858909833918594*^9}},ExpressionUUID->"178572df-4c09-4327-b3ec-\
fb1972eceffa"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Calculate", " ", "the", " ", "probability", " ", "of", " ", "losses"}], 
    ",", 
    RowBox[{"P", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["L", "n"], ">", "\[Tau]"}], ")"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"np", "=", "100000"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"a", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Eta]", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"tilt", " ", "\[Theta]", " ", "only"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"P", 
      RowBox[{"(", 
       RowBox[{"X", ">", "a"}], ")"}]}], ",", " ", 
     RowBox[{"a", "=", "1"}], ",", "2", ",", "3", ",", "4"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]", "=", "1.33834"}], ";", 
    RowBox[{"\[Eta]", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]", "=", "2.22451"}], ";", 
    RowBox[{"\[Eta]", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]", "=", "3.14329"}], ";", 
    RowBox[{"\[Eta]", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]", "=", "4.07787"}], ";", 
    RowBox[{"\[Eta]", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"tilt", " ", "\[Eta]", " ", "only"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"P", 
      RowBox[{"(", 
       RowBox[{"X", ">", "a"}], ")"}]}], ",", " ", 
     RowBox[{"a", "=", "1"}], ",", "2", ",", "3", ",", "4"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]", "=", "0"}], ";", 
    RowBox[{"\[Eta]", "=", "0.256644"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]", "=", "0"}], ";", 
    RowBox[{"\[Eta]", "=", "0.400343"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]", "=", "0"}], ";", 
    RowBox[{"\[Eta]", "=", "0.449544"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]", "=", "0"}], ";", 
    RowBox[{"\[Eta]", "=", "0.47031"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Note", ":", " ", 
      RowBox[{"Initial", " ", "values", " ", "are", " ", "critical"}]}], ",", 
     " ", 
     RowBox[{
     "which", " ", "should", " ", "be", " ", "close", " ", "to", " ", 
      RowBox[{"1", "/", "2."}]}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"tilt", " ", 
     RowBox[{"(", 
      RowBox[{"\[Theta]", ",", "\[Eta]"}], ")"}], " ", "simultaneously"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"P", 
      RowBox[{"(", 
       RowBox[{"X", ">", "a"}], ")"}]}], ",", " ", 
     RowBox[{"a", "=", "1"}], ",", "2", ",", "3", ",", "4"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]", "=", "3.96603"}], ";", 
    RowBox[{"\[Eta]", "=", 
     RowBox[{"-", "0.923822"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]", "=", "9.60937"}], ";", 
    RowBox[{"\[Eta]", "=", 
     RowBox[{"-", "1.63062"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]", "=", "18.2756"}], ";", 
    RowBox[{"\[Eta]", "=", 
     RowBox[{"-", "2.38805"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]", "=", "38.6241"}], ";", 
    RowBox[{"\[Eta]", "=", 
     RowBox[{"-", "4.15754"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Note", ":", " ", "1"}], ")"}], " ", "low", " ", 
         "convergence"}], ",", " ", 
        RowBox[{
         RowBox[{
         "so", " ", "change", " ", "the", " ", "criterion", " ", "to", " ", 
          SuperscriptBox["10", 
           RowBox[{"-", "2"}]]}], ";", " ", "2"}]}], ")"}], " ", "set", " ", 
      "the", " ", "intitial", " ", "value", " ", "of", " ", "\[Eta]", " ", 
      "to", " ", "the", " ", "optimal", " ", "one", " ", "for", " ", "a"}], 
     "-", "1"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Mu]", "=", 
     RowBox[{"\[Theta]", "/", 
      RowBox[{"(", 
       RowBox[{"1", " ", "-", " ", 
        RowBox[{"2", " ", "\[Eta]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]", "=", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"1", " ", "-", " ", 
         RowBox[{"2", " ", "\[Eta]"}]}], ")"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<\[Mu]=\>\"", ",", "\[Mu]", ",", " ", "\"\< \[Sigma]=\>\"", ",", " ",
       "\[Sigma]"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"z", "=", 
     RowBox[{"RandomVariate", "[", 
      RowBox[{
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"\[Mu]", ",", "\[Sigma]"}], "]"}], ",", "np"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"est", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", "np"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "\[LessEqual]", "np"}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"z", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ")"}], "\[LessEqual]", "a"}], ",", 
        
        RowBox[{
         RowBox[{"est", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", "0"}], ",", 
        RowBox[{
         RowBox[{"est", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", 
         RowBox[{"1", "*", "\[Sigma]", "*", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"z", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "*", 
             RowBox[{
              RowBox[{"z", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "/", 
              RowBox[{"(", "2", ")"}]}]}], "+", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"z", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "-", "\[Mu]"}], ")"}], "2"], 
             "/", 
             RowBox[{"(", 
              RowBox[{"2", "*", 
               SuperscriptBox["\[Sigma]", "2"]}], ")"}]}]}], "]"}]}]}]}], 
       "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"N", "@", 
     RowBox[{"Mean", "[", "est", "]"}]}], "//", "ScientificForm"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"N", "@", 
     RowBox[{"Variance", "[", "est", "]"}]}], "//", "ScientificForm"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.70323897773109*^9, 3.703238992722711*^9}, {
   3.703239032280425*^9, 3.7032391477693443`*^9}, {3.703239202153314*^9, 
   3.703239202216435*^9}, {3.703239258615238*^9, 3.703239260332302*^9}, {
   3.7032393046770897`*^9, 3.703239406687592*^9}, {3.703243132672022*^9, 
   3.7032431462340927`*^9}, {3.703243252559514*^9, 3.703243307118034*^9}, {
   3.7032433885506773`*^9, 3.703243443199582*^9}, {3.7032435608618526`*^9, 
   3.703243590389591*^9}, {3.7032436666085443`*^9, 3.703243746951921*^9}, {
   3.703243777423685*^9, 3.7032437774686413`*^9}, {3.703243812768558*^9, 
   3.703243839687924*^9}, {3.703243871767603*^9, 3.7032439572815943`*^9}, {
   3.703244013101323*^9, 3.7032440542552547`*^9}, {3.703291531147869*^9, 
   3.703291564512724*^9}, 3.703291660016891*^9, {3.7032916973372173`*^9, 
   3.7032917043035088`*^9}, {3.703291734472199*^9, 3.703291741342947*^9}, {
   3.70329179486477*^9, 3.7032918162622223`*^9}, {3.703291896144249*^9, 
   3.7032918980354137`*^9}, {3.703292684754017*^9, 3.703292685792156*^9}, 
   3.703292726303371*^9, {3.703292759790022*^9, 3.703292763796179*^9}, {
   3.7032928238190823`*^9, 3.703292841420142*^9}, {3.7032934149822493`*^9, 
   3.703293427547402*^9}, 3.703294535906651*^9, {3.703295525810873*^9, 
   3.703295530502214*^9}, {3.703295599508765*^9, 3.703295602908617*^9}, 
   3.703296053078106*^9, {3.7032964639105387`*^9, 3.703296466191846*^9}, {
   3.7033306324566917`*^9, 3.703330635331851*^9}, {3.703331684966793*^9, 
   3.7033316877445374`*^9}, {3.703332030219204*^9, 3.7033320325060387`*^9}, {
   3.703332500637939*^9, 3.7033325178039618`*^9}, {3.7033351744868*^9, 
   3.703335176637175*^9}, {3.706180042199176*^9, 3.706180046061631*^9}, {
   3.7063530792006903`*^9, 3.706353161574431*^9}, {3.706353337176839*^9, 
   3.7063533401699057`*^9}, {3.706353421996559*^9, 3.706353439969905*^9}, {
   3.7063534994626226`*^9, 3.706353523876308*^9}, {3.70635356408147*^9, 
   3.7063535823023376`*^9}, {3.706353726379739*^9, 3.706353788588835*^9}, {
   3.7063538496094933`*^9, 3.706353859903161*^9}, {3.7063538916884127`*^9, 
   3.706353926405218*^9}, {3.706354007483451*^9, 3.7063540829010563`*^9}, {
   3.706354126948975*^9, 3.7063541410659027`*^9}, {3.706354232538623*^9, 
   3.7063542348891478`*^9}, {3.706354296743902*^9, 3.706354300102125*^9}, {
   3.706354352223097*^9, 3.706354354341688*^9}, {3.706354491731037*^9, 
   3.706354493977666*^9}, {3.706354592982182*^9, 3.706354595934532*^9}, {
   3.706354639242774*^9, 3.7063546400105047`*^9}, {3.706354812083168*^9, 
   3.70635481505094*^9}, {3.706354949387073*^9, 3.706354952012451*^9}, {
   3.7063551229189653`*^9, 3.70635512480523*^9}, {3.707979237678093*^9, 
   3.707979281061739*^9}, {3.7079796022227573`*^9, 3.707979602513473*^9}, {
   3.707979746322075*^9, 3.707979746530724*^9}, {3.707979846213859*^9, 
   3.707979846343155*^9}, {3.707979898000721*^9, 3.7079799103343353`*^9}, {
   3.707979954029179*^9, 3.7079799542864027`*^9}, {3.7079800115385637`*^9, 
   3.7079800117152967`*^9}, {3.707980083426193*^9, 3.707980083604795*^9}, 
   3.708138990073799*^9, {3.708139100294014*^9, 3.708139100843318*^9}, {
   3.708139319687193*^9, 3.708139353089851*^9}, {3.708139407656242*^9, 
   3.708139481868294*^9}, {3.708139582279584*^9, 3.70813958523768*^9}, {
   3.708139624332655*^9, 3.708139628435129*^9}, {3.7081396605140343`*^9, 
   3.708139674811965*^9}, {3.708139743324787*^9, 3.708139745403018*^9}, {
   3.7081398217108517`*^9, 3.708139859093214*^9}, 3.708139994311895*^9, {
   3.70814007461362*^9, 3.708140077827586*^9}, {3.7081401310140038`*^9, 
   3.708140133860764*^9}, {3.708140166084642*^9, 3.708140169554913*^9}, {
   3.708140202750766*^9, 3.708140203750209*^9}, {3.708140250148932*^9, 
   3.708140252099247*^9}, 3.708140344546363*^9, {3.708140401730527*^9, 
   3.708140404392853*^9}, {3.708140461653369*^9, 3.708140464300537*^9}, {
   3.708140591543466*^9, 3.708140594645686*^9}, {3.708140643356105*^9, 
   3.708140655008169*^9}, {3.708140685272703*^9, 3.708140689478244*^9}, {
   3.7081407349217367`*^9, 3.7081407719539223`*^9}, {3.708140829588298*^9, 
   3.708140856696227*^9}, {3.708140902654508*^9, 3.708140902820299*^9}, {
   3.7081409680335093`*^9, 3.7081409683383408`*^9}, {3.708141041383379*^9, 
   3.708141108386446*^9}, {3.708141168951036*^9, 3.708141171741661*^9}, {
   3.708141360069769*^9, 3.70814136052722*^9}, {3.708141538748193*^9, 
   3.708141547019288*^9}, {3.708141755836108*^9, 3.708141762370295*^9}, {
   3.708141840847822*^9, 3.708141884196637*^9}, {3.708142560761156*^9, 
   3.708142562999621*^9}, {3.857122013544186*^9, 3.857122107434093*^9}, {
   3.857122151356784*^9, 3.857122161435893*^9}, {3.85712226037729*^9, 
   3.8571223055945187`*^9}, {3.857122409783515*^9, 3.857122440173915*^9}, {
   3.8571228537545347`*^9, 3.85712288728157*^9}, {3.857122949248932*^9, 
   3.857122961912896*^9}, {3.8571616793117228`*^9, 3.857161679508727*^9}, {
   3.857162323715954*^9, 3.857162390737706*^9}, {3.857162451040572*^9, 
   3.8571624605730047`*^9}, {3.857162540934986*^9, 3.8571625528555593`*^9}, 
   3.857162610872342*^9, {3.8571626935099487`*^9, 3.857162724261952*^9}, {
   3.857162779014078*^9, 3.8571627925246553`*^9}, {3.85716284227456*^9, 
   3.857162851816242*^9}, {3.8571628995596523`*^9, 3.8571629086294622`*^9}, {
   3.8571631054004583`*^9, 3.857163115570335*^9}, {3.85716325082905*^9, 
   3.8571632545123863`*^9}, {3.8571634625819063`*^9, 3.857163469442081*^9}, {
   3.857163575078805*^9, 3.8571635845628357`*^9}, {3.857163633102956*^9, 
   3.857163692787747*^9}, {3.857163794360873*^9, 3.857163822961754*^9}, 
   3.857164502042551*^9, {3.857165201729391*^9, 3.857165204835742*^9}, {
   3.857165304097995*^9, 3.8571653534557543`*^9}, {3.857165571834075*^9, 
   3.857165573941824*^9}, {3.857165666746582*^9, 3.857165682131754*^9}, {
   3.857166655374551*^9, 3.8571666603246*^9}, {3.857166759514093*^9, 
   3.85716677970643*^9}, {3.857178575830824*^9, 3.857178620048321*^9}, 
   3.8571787794795103`*^9, {3.857179102029999*^9, 3.857179115439712*^9}, {
   3.858889950510257*^9, 3.858890042483756*^9}, {3.858891633435132*^9, 
   3.858891663822249*^9}, {3.8588917794456863`*^9, 3.858891779714958*^9}, {
   3.858891810650442*^9, 3.8588918655070953`*^9}, {3.858891917398465*^9, 
   3.85889191789495*^9}, {3.858892120503696*^9, 3.858892125453342*^9}, {
   3.858892231295018*^9, 3.85889223151309*^9}, {3.85889228100033*^9, 
   3.858892284217699*^9}, {3.858892315822411*^9, 3.8588923430614634`*^9}, {
   3.858892551081746*^9, 3.8588925757609243`*^9}, 3.858892793376289*^9, {
   3.8588932505860567`*^9, 3.858893250994501*^9}, {3.858893430614235*^9, 
   3.858893488980323*^9}, {3.858893690709816*^9, 3.858893715911291*^9}, {
   3.858893757222609*^9, 3.858893786897224*^9}, {3.858893841798389*^9, 
   3.858893942775014*^9}, {3.8588940404781837`*^9, 3.858894055037075*^9}, 
   3.858909840636445*^9, {3.858909912065715*^9, 3.858909955254887*^9}, {
   3.858910002985374*^9, 3.858910051913369*^9}, {3.8589100886955843`*^9, 
   3.858910136645824*^9}, 3.858910173117179*^9, {3.864939030611926*^9, 
   3.8649390306801023`*^9}},ExpressionUUID->"538fc3c9-e1ed-453f-93d3-\
2756002965da"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Determine", " ", "optimal", " ", "tilting", " ", "parameters"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"np", "=", "100000"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[ScriptCapitalD]", "1"], "=", 
     RowBox[{"RandomVariate", "[", 
      RowBox[{
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"0", ",", "1"}], "]"}], ",", "np"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"a", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Eta]", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"j", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"g1", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"g2", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"While", "[", 
     RowBox[{"True", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"j", "++"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"tmp1", "=", "\[Theta]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"tmp2", " ", "=", "\[Eta]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"f0", "[", "z_", "]"}], ":=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"z", ">", "a"}], ",", "1", ",", "0"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"f1", "[", "z_", "]"}], ":=", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Theta]", " ", "z"}], "+", 
             RowBox[{"\[Eta]", " ", 
              SuperscriptBox["z", "2"]}]}], ")"}]}], " ", "]"}], "*", 
         RowBox[{"f0", "[", "z", "]"}], "*", "z"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"f2", "[", "z_", "]"}], ":=", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Theta]", " ", "z"}], "+", 
             RowBox[{"\[Eta]", " ", 
              SuperscriptBox["z", "2"]}]}], ")"}]}], " ", "]"}], "*", 
         RowBox[{"f0", "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"f3", "[", "z_", "]"}], ":=", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Theta]", " ", "z"}], "+", 
             RowBox[{"\[Eta]", " ", 
              SuperscriptBox["z", "2"]}]}], ")"}]}], " ", "]"}], "*", 
         RowBox[{"f0", "[", "z", "]"}], "*", 
         SuperscriptBox["z", "2"]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"f4", "[", "z_", "]"}], ":=", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Theta]", " ", "z"}], "+", 
             RowBox[{"\[Eta]", " ", 
              SuperscriptBox["z", "2"]}]}], ")"}]}], " ", "]"}], "*", 
         RowBox[{"f0", "[", "z", "]"}], "*", 
         RowBox[{"-", 
          SuperscriptBox["z", "2"]}]}]}], ";", 
       RowBox[{"(*", " ", 
        RowBox[{"D", "[", 
         RowBox[{"f4", ",", "\[Theta]"}], "]"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"f5", "[", "z_", "]"}], ":=", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Theta]", " ", "z"}], "+", 
             RowBox[{"\[Eta]", " ", 
              SuperscriptBox["z", "2"]}]}], ")"}]}], " ", "]"}], "*", 
         RowBox[{"f0", "[", "z", "]"}], "*", 
         RowBox[{"-", "z"}]}]}], ";", 
       RowBox[{"(*", " ", 
        RowBox[{"D", "[", 
         RowBox[{"f2", ",", "\[Theta]"}], "]"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"f6", "[", "z_", "]"}], ":=", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Theta]", " ", "z"}], "+", 
             RowBox[{"\[Eta]", " ", 
              SuperscriptBox["z", "2"]}]}], ")"}]}], " ", "]"}], "*", 
         RowBox[{"f0", "[", "z", "]"}], "*", 
         RowBox[{"-", 
          SuperscriptBox["z", "4"]}]}]}], ";", 
       RowBox[{"(*", " ", 
        RowBox[{"D", "[", 
         RowBox[{"f3", ",", "\[Eta]"}], "]"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"f7", "[", "z_", "]"}], ":=", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Theta]", " ", "z"}], "+", 
             RowBox[{"\[Eta]", " ", 
              SuperscriptBox["z", "2"]}]}], ")"}]}], " ", "]"}], "*", 
         RowBox[{"f0", "[", "z", "]"}], "*", 
         RowBox[{"-", 
          SuperscriptBox["z", "2"]}]}]}], ";", 
       RowBox[{"(*", " ", 
        RowBox[{"D", "[", 
         RowBox[{"f2", ",", "\[Eta]"}], "]"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"a1", "=", 
        RowBox[{"Mean", "[", 
         RowBox[{"MapThread", "[", 
          RowBox[{"f1", ",", 
           SubscriptBox["\[ScriptCapitalD]", "1"]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"a2", "=", 
        RowBox[{"Mean", "[", 
         RowBox[{"MapThread", "[", 
          RowBox[{"f2", ",", 
           SubscriptBox["\[ScriptCapitalD]", "1"]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"a3", "=", 
        RowBox[{"Mean", "[", 
         RowBox[{"MapThread", "[", 
          RowBox[{"f3", ",", 
           SubscriptBox["\[ScriptCapitalD]", "1"]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"a4", "=", 
        RowBox[{"Mean", "[", 
         RowBox[{"MapThread", "[", 
          RowBox[{"f4", ",", 
           SubscriptBox["\[ScriptCapitalD]", "1"]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"a5", "=", 
        RowBox[{"Mean", "[", 
         RowBox[{"MapThread", "[", 
          RowBox[{"f5", ",", 
           SubscriptBox["\[ScriptCapitalD]", "1"]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"a6", "=", 
        RowBox[{"Mean", "[", 
         RowBox[{"MapThread", "[", 
          RowBox[{"f6", ",", 
           SubscriptBox["\[ScriptCapitalD]", "1"]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"a7", "=", 
        RowBox[{"Mean", "[", 
         RowBox[{"MapThread", "[", 
          RowBox[{"f7", ",", 
           SubscriptBox["\[ScriptCapitalD]", "1"]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"g1", "=", 
        RowBox[{
         RowBox[{"\[Theta]", "/", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", "\[Eta]"}]}], ")"}]}], "-", 
         RowBox[{"a1", "/", "a2"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Jacob1", "=", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", "\[Eta]"}]}], ")"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a4", "*", "a2"}], "-", 
            RowBox[{"a1", "*", "a5"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"a2", "*", "a2"}], ")"}]}]}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"D", "[", 
         RowBox[{"g1", ",", "\[Theta]"}], "]"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"\[Theta]", "=", 
        RowBox[{"tmp1", "-", 
         RowBox[{
          RowBox[{"1", "/", "Jacob1"}], "*", "g1"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"g2", "=", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", "\[Eta]"}]}], ")"}]}], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"\[Theta]", "/", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"2", "\[Eta]"}]}], ")"}]}], ")"}], "2"], "-", 
         RowBox[{"a3", "/", "a2"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Jacob2", "=", 
        RowBox[{
         FractionBox["2", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", " ", "\[Eta]"}]}], ")"}], "2"]], "+", 
         FractionBox[
          RowBox[{"4", " ", 
           SuperscriptBox["\[Theta]", "2"]}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", " ", "\[Eta]"}]}], ")"}], "3"]], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a6", "*", "a2"}], "-", 
            RowBox[{"a3", "*", "a7"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"a2", "*", "a2"}], ")"}]}]}]}], ";", 
       RowBox[{"(*", " ", 
        RowBox[{"D", "[", 
         RowBox[{"g2", ",", "\[Eta]"}], "]"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"\[Eta]", "=", 
        RowBox[{"tmp2", "-", 
         RowBox[{
          RowBox[{"1", "/", "Jacob2"}], "*", "g2"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<j:\>\"", ",", " ", "j", ",", "\"\< \[Theta]=\>\"", ",", " ", 
         "\[Theta]", ",", " ", "\"\<; \[Eta]=\>\"", ",", " ", "\[Eta]", ",", 
         " ", "\"\<;\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Norm", "[", "g1", "]"}], ")"}], "^", "2"}], "<", 
              SuperscriptBox["10", 
               RowBox[{"-", "4"}]]}], " ", "&&", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Norm", "[", "g2", "]"}], ")"}], "^", "2"}], "<", 
              SuperscriptBox["10", 
               RowBox[{"-", "4"}]]}]}], " ", "||", 
            RowBox[{"j", ">", "200"}]}], ",", 
           RowBox[{
            RowBox[{"Break", "[", "]"}], ";"}]}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"looser", " ", "criteria", " ", "for", " ", "tilting", " ", 
         RowBox[{"(", 
          RowBox[{"\[Mu]", ",", "\[Sigma]"}], ")"}], " ", "simultaneously"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Norm", "[", "g1", "]"}], ")"}], "^", "2"}], "<", 
            SuperscriptBox["10", 
             RowBox[{"-", "2"}]]}], " ", "&&", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Norm", "[", "g2", "]"}], ")"}], "^", "2"}], "<", 
            SuperscriptBox["10", 
             RowBox[{"-", "2"}]]}]}], " ", "||", 
          RowBox[{"j", ">", "200"}]}], ",", 
         RowBox[{
          RowBox[{"Break", "[", "]"}], ";"}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}]}]}]], "Input",\

 CellChangeTimes->{{3.703291640753374*^9, 3.703291648704081*^9}, {
   3.7032917573523912`*^9, 3.703291771485688*^9}, {3.703291835762344*^9, 
   3.703291870455429*^9}, {3.703292471721944*^9, 3.703292490776328*^9}, {
   3.703292541431156*^9, 3.703292671384821*^9}, {3.703292703873302*^9, 
   3.703292705455491*^9}, {3.703292806309557*^9, 3.7032928073235292`*^9}, {
   3.7032931556220284`*^9, 3.703293161811646*^9}, {3.703293251387558*^9, 
   3.7032932684569073`*^9}, {3.703293395209194*^9, 3.7032933985894012`*^9}, {
   3.7032935542098837`*^9, 3.703293557230103*^9}, {3.70329380584457*^9, 
   3.703293824145122*^9}, {3.703293953626055*^9, 3.7032940049552183`*^9}, {
   3.7032942434154043`*^9, 3.703294259939104*^9}, {3.703294339199214*^9, 
   3.703294454219228*^9}, {3.703295006929398*^9, 3.703295030753624*^9}, {
   3.703295094996203*^9, 3.703295198024213*^9}, {3.703295292472516*^9, 
   3.703295326227602*^9}, {3.703295431235115*^9, 3.703295431480379*^9}, {
   3.7032955407139606`*^9, 3.703295541726207*^9}, {3.703295744216702*^9, 
   3.703295757056222*^9}, {3.703295802546089*^9, 3.703295919866428*^9}, {
   3.703295949888175*^9, 3.703295978791551*^9}, {3.703296135360716*^9, 
   3.703296162034678*^9}, {3.703296204246003*^9, 3.703296227407481*^9}, {
   3.703296290910116*^9, 3.7032962910217743`*^9}, {3.7032964814880733`*^9, 
   3.703296481757842*^9}, {3.7033299759127817`*^9, 3.703329975982602*^9}, {
   3.703330656891089*^9, 3.703330656976631*^9}, {3.7033317071540127`*^9, 
   3.703331707248394*^9}, {3.703332051549214*^9, 3.7033320517306213`*^9}, {
   3.70333253792693*^9, 3.703332538116647*^9}, {3.7033330644735327`*^9, 
   3.703333064638935*^9}, {3.706349657795698*^9, 3.706349779149644*^9}, {
   3.7063514559260607`*^9, 3.706351498473029*^9}, {3.706351597547228*^9, 
   3.7063516097958317`*^9}, {3.706351764553843*^9, 3.7063517741023607`*^9}, 
   3.706351960187071*^9, 3.706351997236487*^9, {3.7063523176491337`*^9, 
   3.70635231964625*^9}, {3.706352380306519*^9, 3.7063523803937883`*^9}, {
   3.706353166680272*^9, 3.7063531692884007`*^9}, {3.706353359809973*^9, 
   3.706353359896181*^9}, {3.706353516520316*^9, 3.7063535167589397`*^9}, {
   3.706353704321725*^9, 3.706353704415963*^9}, {3.7063540004949512`*^9, 
   3.70635400270018*^9}, {3.7063542659116383`*^9, 3.706354266078404*^9}, {
   3.706354322850403*^9, 3.7063543229586687`*^9}, {3.706354445771389*^9, 
   3.706354445993038*^9}, {3.7063545211739902`*^9, 3.70635452748195*^9}, {
   3.706354666044921*^9, 3.7063546661312103`*^9}, {3.706354870994726*^9, 
   3.70635487113657*^9}, {3.706354995509995*^9, 3.7063549957077513`*^9}, {
   3.707979296473288*^9, 3.7079793252802277`*^9}, 3.7079793554293337`*^9, {
   3.707979394177783*^9, 3.707979502441697*^9}, 3.7079795380033484`*^9, {
   3.707979684941144*^9, 3.707979690218696*^9}, {3.707979772418397*^9, 
   3.7079797738484583`*^9}, {3.70797992669626*^9, 3.707979927775334*^9}, {
   3.707979982892941*^9, 3.707979984691392*^9}, {3.707980047506838*^9, 
   3.70798005250485*^9}, {3.7081392385643578`*^9, 3.70813925368191*^9}, {
   3.708139541297735*^9, 3.7081395616574907`*^9}, {3.708139612952916*^9, 
   3.708139613198543*^9}, {3.708139643749323*^9, 3.708139643810986*^9}, {
   3.70813968773873*^9, 3.7081397145204487`*^9}, {3.708139764781006*^9, 
   3.708139766307212*^9}, {3.708140019047761*^9, 3.708140019107328*^9}, {
   3.708140114452937*^9, 3.7081401145205393`*^9}, {3.708140199060611*^9, 
   3.7081401991528273`*^9}, {3.708140292003491*^9, 3.7081402979054127`*^9}, {
   3.708140364368053*^9, 3.708140364445609*^9}, {3.708140424675798*^9, 
   3.70814042476791*^9}, {3.7081404875581627`*^9, 3.708140487730583*^9}, {
   3.7081409259850187`*^9, 3.708140931659115*^9}, {3.708140989200191*^9, 
   3.7081409893269863`*^9}, {3.708141066537695*^9, 3.708141066832234*^9}, {
   3.7081411262925797`*^9, 3.708141126577982*^9}, {3.708141231980485*^9, 
   3.7081412335392637`*^9}, 3.708141385119567*^9, {3.708141567467358*^9, 
   3.708141567801037*^9}, {3.7081417764513206`*^9, 3.708141776497983*^9}, {
   3.857119019355884*^9, 3.857119019464877*^9}, {3.857119061702437*^9, 
   3.857119106142898*^9}, {3.85711914661304*^9, 3.857119147748711*^9}, {
   3.857119184224454*^9, 3.857119184964375*^9}, {3.8571192232057257`*^9, 
   3.857119278303975*^9}, 3.857119488431395*^9, {3.857119617376644*^9, 
   3.8571196488536577`*^9}, {3.857119704910673*^9, 3.8571197158642893`*^9}, {
   3.857119774921974*^9, 3.8571197775114183`*^9}, {3.857119814010765*^9, 
   3.8571198296979237`*^9}, {3.857119965646405*^9, 3.857119973970294*^9}, {
   3.857120073659399*^9, 3.85712011289158*^9}, {3.857120155007206*^9, 
   3.857120187766942*^9}, {3.857120357904195*^9, 3.8571203744066057`*^9}, {
   3.857120422333685*^9, 3.857120568971499*^9}, {3.857120855759141*^9, 
   3.857120855864111*^9}, {3.85712103268293*^9, 3.857121049969413*^9}, {
   3.857121471625493*^9, 3.857121471741197*^9}, {3.857121540471685*^9, 
   3.8571215420315104`*^9}, {3.8571215867016706`*^9, 3.857121586783744*^9}, {
   3.857121825583786*^9, 3.857121834261238*^9}, {3.857121866940728*^9, 
   3.857121867405643*^9}, {3.857122143919609*^9, 3.8571221440167313`*^9}, {
   3.8571224873789043`*^9, 3.857122489914154*^9}, {3.857122603911276*^9, 
   3.857122645772194*^9}, {3.8571227319189863`*^9, 3.857122740874124*^9}, {
   3.8571227793427067`*^9, 3.8571227810767384`*^9}, {3.8571618673069*^9, 
   3.857161874206609*^9}, {3.857162038742599*^9, 3.857162123719273*^9}, {
   3.857162206565592*^9, 3.857162243495318*^9}, {3.8571623134146347`*^9, 
   3.857162314380739*^9}, {3.8571625916406527`*^9, 3.857162598877467*^9}, {
   3.8571626320760307`*^9, 3.857162674007246*^9}, {3.857162764544814*^9, 
   3.857162764641857*^9}, {3.857162827953554*^9, 3.857162828048506*^9}, {
   3.857162886422639*^9, 3.857162886550865*^9}, {3.8571629354218493`*^9, 
   3.8571629571856413`*^9}, {3.857163289043285*^9, 3.857163333306488*^9}, {
   3.857163426707801*^9, 3.857163428540069*^9}, {3.857163519673476*^9, 
   3.857163554906722*^9}, {3.857163608158142*^9, 3.857163608402981*^9}, {
   3.8571636965124083`*^9, 3.85716371489212*^9}, {3.857163878096136*^9, 
   3.857163979971187*^9}, {3.857164058526976*^9, 3.857164058609272*^9}, {
   3.857164100428568*^9, 3.8571641080223217`*^9}, {3.857164286944289*^9, 
   3.857164290685869*^9}, {3.857164371385764*^9, 3.857164373349218*^9}, {
   3.8571646102386837`*^9, 3.857164610546042*^9}, {3.8571646433617373`*^9, 
   3.857164645072289*^9}, {3.857164686952351*^9, 3.857164688818077*^9}, {
   3.857164812839572*^9, 3.8571648179469013`*^9}, {3.8571648635053368`*^9, 
   3.8571649043517*^9}, {3.857164955577272*^9, 3.857164982697042*^9}, {
   3.8571651256217003`*^9, 3.857165139381078*^9}, {3.857165252400652*^9, 
   3.8571652525027647`*^9}, {3.857165363504806*^9, 3.857165363633198*^9}, {
   3.857165493401196*^9, 3.8571654936162558`*^9}, {3.8571656044733057`*^9, 
   3.857165604584173*^9}, {3.8571657058751917`*^9, 3.857165706044581*^9}, {
   3.8571657497103157`*^9, 3.8571657508116703`*^9}, {3.8588900617440863`*^9, 
   3.858890107705772*^9}, {3.858890210211895*^9, 3.858890211109496*^9}, {
   3.8588915249205923`*^9, 3.858891565224375*^9}, 3.858891599517021*^9, 
   3.858891651664179*^9, {3.858891684855015*^9, 3.858891701788052*^9}, {
   3.8588917328301487`*^9, 3.8588917546733723`*^9}, {3.8588917916562366`*^9, 
   3.858891843236248*^9}, {3.858891881706381*^9, 3.858891893327162*^9}, {
   3.8588919569039373`*^9, 3.858891957017495*^9}, {3.858892131700289*^9, 
   3.858892136871975*^9}, {3.858892172344694*^9, 3.8588921770663233`*^9}, {
   3.8588922395308847`*^9, 3.858892239661277*^9}, {3.8588922875202637`*^9, 
   3.8588922876737137`*^9}, {3.858892356343652*^9, 3.8588924096795607`*^9}, {
   3.858892580985516*^9, 3.858892581234374*^9}, {3.858892801367776*^9, 
   3.858892801466881*^9}, {3.858893018481941*^9, 3.858893021140925*^9}, {
   3.858893261743452*^9, 3.858893265235629*^9}, {3.8588937365420732`*^9, 
   3.858893742647888*^9}, {3.858909890291058*^9, 3.858909896979085*^9}, 
   3.858910108229311*^9, {3.8589102147663927`*^9, 3.858910215235733*^9}, {
   3.859433204187892*^9, 3.859433219267365*^9}, 3.859433259987216*^9, {
   3.859433300836969*^9, 3.859433393657929*^9}, {3.8649391078604116`*^9, 
   3.864939115793154*^9}},ExpressionUUID->"a9350541-ce19-4dca-93c3-\
b99ff5f707fd"]
},
WindowSize->{1414, 848},
WindowMargins->{{Automatic, 53}, {Automatic, 92}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
FrontEndVersion->"13.0 for Mac OS X x86 (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"690ea912-3cdb-499b-8079-9d70dab1c94a"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 284, 7, 52, "Input",ExpressionUUID->"178572df-4c09-4327-b3ec-fb1972eceffa"],
Cell[844, 29, 14387, 301, 942, "Input",ExpressionUUID->"538fc3c9-e1ed-453f-93d3-2756002965da"],
Cell[15234, 332, 19899, 426, 1161, "Input",ExpressionUUID->"a9350541-ce19-4dca-93c3-b99ff5f707fd"]
}
]
*)

